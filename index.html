<!DOCTYPE html>
<html lang="nl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Etiketten Generator</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app">
      <header class="app-header">
        <div class="brand">
          <div class="brand-text">
            <h1>
              Etiketten Generator<span class="version-badge">v0.115</span>
            </h1>
          </div>
          <a
            href="https://lifegoodsgroup.com/"
            class="brand-logo-link"
            aria-label="LifeGoods Group"
            target="_blank"
            rel="noopener noreferrer"
          >
            <img
              src="assets/Lifegoods-logo.png"
              alt="LifeGoods Group B.V."
              class="client-logo"
            />
          </a>
        </div>
      </header>

      <main class="app-main">
        <nav class="tabs" role="tablist" aria-label="Etiketten Generator tabs">
          <button
            type="button"
            class="tab-btn active"
            role="tab"
            id="tabBtnSingle"
            aria-selected="true"
            aria-controls="tab-single"
            data-tab-target="tab-single"
          >
            Single-PDF
          </button>
          <button
            type="button"
            class="tab-btn"
            role="tab"
            id="tabBtnBulk"
            aria-selected="false"
            aria-controls="tab-bulk"
            data-tab-target="tab-bulk"
          >
            Bulk-Upload
          </button>
          <button
            type="button"
            class="tab-btn"
            role="tab"
            id="tabBtnDoc"
            aria-selected="false"
            aria-controls="tab-doc"
            data-tab-target="tab-doc"
          >
            Documentatie
          </button>
        </nav>

        <div class="tab-panels">
          <div
            id="tab-single"
            class="tab-panel"
            role="tabpanel"
            aria-labelledby="tabBtnSingle"
          >
            <div class="single-split">
              <section class="panel panel-form">
                <h2>Gegevens</h2>

                <div class="form-grid">
                  <label class="field">
                    <span>ERP</span>
                    <input id="erp" type="text" value="LG1000843" />
                  </label>

                  <label class="field span-2">
                    <span>Productomschrijving</span>
                    <textarea id="desc" rows="3">
Combination Lock - Orange - 1 Pack (YF20610B)</textarea
                    >
                  </label>

                  <label class="field">
                    <span>EAN</span>
                    <input id="ean" type="text" value="8719632951889" />
                  </label>

                  <label class="field">
                    <span>QTY (PCS)</span>
                    <input id="qty" type="text" value="12" />
                  </label>

                  <label class="field">
                    <span>G.W (KGS)</span>
                    <input id="gw" type="text" value="18,00" />
                  </label>

                  <label class="field">
                    <span>CBM</span>
                    <input id="cbm" type="text" value="0.02" />
                  </label>

                  <label class="field">
                    <span>Length (L)</span>
                    <input id="len" type="text" value="39" />
                  </label>

                  <label class="field">
                    <span>Width (W)</span>
                    <input id="wid" type="text" value="19,5" />
                  </label>

                  <label class="field">
                    <span>Height (H)</span>
                    <input id="hei" type="text" value="22" />
                  </label>

                  <label class="field">
                    <span>Batch</span>
                    <input id="batch" type="text" value="IOR2500307" />
                  </label>
                </div>

                <div class="actions">
                  <button id="btnGen" class="btn primary">Preview</button>
                  <button id="btnPDF" class="btn success">Maak PDF</button>
                </div>
              </section>

              <section class="panel panel-preview">
                <h2>Preview</h2>
                <div id="labelsGrid" class="labels-grid"></div>
              </section>
            </div>

            <section class="panel panel-dims">
              <h2>Berekende labelafmetingen (werkelijke cm)</h2>
              <div class="dims-grid-head">
                <div>Label</div>
                <div>W</div>
                <div>H</div>
                <div>Variant</div>
              </div>
              <div id="dims" class="dims-grid"></div>
            </section>
          </div>

          <div
            id="tab-bulk"
            class="tab-panel hidden"
            role="tabpanel"
            aria-labelledby="tabBtnBulk"
          >
            <section class="panel batch-panel">
              <h2>Batch (Excel / CSV)</h2>

              <div class="upload-row">
                <label class="dropzone" id="dropzone">
                  <input
                    type="file"
                    id="fileInput"
                    accept=".xlsx,.xls,.csv"
                    hidden
                  />
                  <span
                    ><strong>Bestand kiezen</strong> of sleep hierheen (xlsx,
                    xls, csv)</span
                  >
                </label>

                <div class="batch-actions">
                  <button type="button" id="btnPickFile" class="btn">
                    Kies bestand…
                  </button>
                  <button type="button" id="btnTemplateCsv" class="btn">
                    Template (CSV)
                  </button>
                  <button type="button" id="btnTemplateXlsx" class="btn">
                    Template (XLSX)
                  </button>
                </div>
              </div>

              <div id="mappingWrap" class="mapping hidden">
                <h3>Kolommen koppelen</h3>
                <div id="mappingGrid" class="mapping-grid"></div>
                <p class="hint">
                  Automatisch gedetecteerd. Pas aan indien nodig.
                </p>
              </div>

              <div id="previewWrap" class="table-wrap hidden">
                <h3>Voorbeeld (eerste 5 rijen)</h3>
                <div id="tablePreview" class="table-scroller"></div>
              </div>

              <div id="normWrap" class="norms hidden">
                <h3>Normalisatie</h3>
                <label
                  ><input type="checkbox" id="optCommaDecimal" checked /> Komma
                  als decimaal scheidingsteken (1,25 → 1.25)</label
                >
                <label
                  ><input type="checkbox" id="optTrimSpaces" checked /> Spaties
                  rondom waarden verwijderen</label
                >
              </div>

              <div class="batch-controls hidden" id="batchControls">
                <button type="button" id="btnRunBatch" class="btn primary">
                  PDF’s genereren (batch)
                </button>
                <button
                  type="button"
                  id="btnAbortBatch"
                  class="btn danger"
                  disabled
                >
                  Stoppen
                </button>
              </div>

              <div id="progressWrap" class="progress-wrap hidden">
                <div class="progress-bar">
                  <div id="progressBar" class="bar"></div>
                </div>
                <div class="progress-text">
                  <span id="progressLabel">0 / 0</span>
                  <span id="progressPhase"></span>
                </div>
              </div>

              <div id="logWrap" class="log-wrap hidden">
                <h3>Log</h3>
                <div id="logList" class="log-list"></div>
              </div>
            </section>
          </div>

          <div
            id="tab-doc"
            class="tab-panel hidden"
            role="tabpanel"
            aria-labelledby="tabBtnDoc"
          >
            <section class="panel">
              <h2>Documentatie</h2>

              <p class="muted">
                Deze pagina beschrijft de invoervelden, de batch-upload
                (Excel/CSV) en de PDF-output.
              </p>

              <h3>Single-PDF</h3>
              <p>
                Vul de velden in en klik op
                <strong>Preview</strong> voor de preview. Klik daarna op
                <strong>Maak PDF</strong> om een PDF te downloaden.
              </p>

              <h3>Invoervelden</h3>
              <ul class="doc-list">
                <li><strong>ERP</strong>: interne ERP-code (tekst).</li>
                <li>
                  <strong>Productomschrijving</strong>: korte omschrijving
                  (tekst).
                </li>
                <li>
                  <strong>EAN</strong>: EAN/GTIN code (tekst of numeriek).
                </li>
                <li><strong>Aantal</strong>: aantal stuks (numeriek).</li>
                <li><strong>GW</strong>: brutogewicht (kg).</li>
                <li><strong>CBM</strong>: kubieke meter (m³).</li>
                <li>
                  <strong>Afmetingen doos</strong>: <strong>L</strong>,
                  <strong>B</strong>, <strong>H</strong> (cm).
                </li>
                <li><strong>Batch</strong>: batch/lot nummer (tekst).</li>
              </ul>

              <h3>Bulk-Upload</h3>
              <p>
                Upload een XLSX/XLS/CSV en koppel daarna de kolommen aan de
                velden. Gebruik de template-knoppen om een voorbeeldbestand te
                downloaden.
              </p>

              <h3>Normalisatie</h3>
              <ul class="doc-list">
                <li>
                  <strong>Komma als decimaal</strong>: zet <code>1,25</code> om
                  naar <code>1.25</code> indien aangevinkt.
                </li>
                <li>
                  <strong>Spaties trimmen</strong>: verwijdert spaties rondom
                  waarden.
                </li>
              </ul>

              <h3>Links</h3>
              <p>
                LifeGoods Group website:
                <a
                  href="https://lifegoodsgroup.com/"
                  target="_blank"
                  rel="noopener noreferrer"
                  >lifegoodsgroup.com</a
                >
              </p>
            </section>
          </div>
        </div>
      </main>
    </div>

    <footer class="app-footer" role="contentinfo">
      <div class="app-footer__inner">
        © <span id="copyrightYear"></span>
        <a href="http://studiord.nl" target="_blank" rel="noopener noreferrer"
          >Studio RD</a
        >
        – onderdeel van Renée de Vries.
      </div>
    </footer>

    <!-- libs -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

    <script src="app.js"></script>

    <script>
      document.getElementById("copyrightYear").textContent =
        new Date().getFullYear();
    </script>
  </body>
</html>
